<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reality Glitch AR</title>
    
    <!-- AR.js and A-Frame libraries -->
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.1/dist/aframe-extras.min.js"></script>
    
    <!-- Custom styling -->
    <link rel="stylesheet" href="style.css">
</head>
<body style="margin: 0; overflow: hidden;">
    <div class="loading-screen">
        <div class="loader"></div>
        <p>Loading Reality Glitch...</p>
    </div>
    
    <!-- AR Scene -->
    <a-scene embedded arjs="sourceType: webcam; debugUIEnabled: false; detectionMode: mono_and_matrix; matrixCodeType: 3x3;">
        
        <!-- Asset management system to preload models -->
        <a-assets>
            <a-asset-item id="portal-model" src="assets/models/deep_space_skybox/scene.gltf"></a-asset-item>
            <!-- <a-asset-item id="impossible-model" src="assets/models/impossible-model.glb"></a-asset-item>
            <a-asset-item id="glitch-model" src="assets/models/glitch-model.glb"></a-asset-item> -->
            
            <audio id="portal-sound" src="assets/sounds/portal.wav"></audio>
            <!-- <audio id="mysterious-sound" src="assets/sounds/mysterious.mp3" preload="auto"></audio>
            <audio id="glitch-sound" src="assets/sounds/glitch.mp3" preload="auto"></audio> -->
            
            <img id="space-sky" src="assets/images/space-sky.jpg">
        </a-assets>
        
        <!-- Define camera -->
        <a-entity camera>
            <a-entity cursor="fuse: false; rayOrigin: mouse;"></a-entity>
        </a-entity>
        
        <!-- Portal Marker with Sketchfab Model -->
        <a-marker id="portal-marker" type="pattern" url="markers/portal.patt">
            <!-- Container for positioning -->
            <a-entity id="model-container" position="0 0.5 0">
                <!-- Portal rim effect -->
                <!-- <a-torus position="0 0 0" radius="1" radius-tubular="0.05" rotation="90 0 0" color="#9400D3" 
                        animation="property: material.emissive; from: #000000; to: #9400D3; dur: 2000; loop: true; dir: alternate"
                        animation__2="property: rotation; from: 90 0 0; to: 90 360 0; dur: 10000; loop: true"></a-torus> -->
                
                <!-- Sketchfab Model (portal/cosmic model) -->
                <a-entity 
                    id="interactive-model"
                    class="clickable"
                    gltf-model="#portal-model"
                    position="0 0 0" 
                    scale="0.1 0.1 0.1"
                    <!-- scale="0.003 0.003 0.003" -->
                    animation-mixer>
                </a-entity>
                
                <!-- Portal particles - keep these for added effect -->
                <a-entity position="0 0.1 0" particle-system="preset: dust; color: #9400D3, #00FFFF, #FF00FF; 
                                                            particleCount: 150; size: 0.1; maxAge: 2;
                                                            velocityValue: 0.1 0.3 0.1; 
                                                            accelerationValue: 0 -0.1 0"></a-entity>
                
                <!-- Portal sound -->
                <a-sound src="#portal-sound" autoplay="true" loop="true" volume="0.5"></a-sound>
            </a-entity>
        </a-marker>

        

    </a-scene>
    
    <!-- UI Elements -->
    <div class="ui-container">
        <div id="tracking-status"></div>
        <div class="instructions">Scan markers to reveal glitches in reality</div>
    </div>

    <div class="help-card">
        <h3>Reality Glitch AR</h3>
        <p>Point your camera at the markers to reveal glitches in reality.</p>
        <p>Tap on objects to interact with them!</p>
        <button id="close-help">Got it</button>
    </div>
    
    <!-- Debug panel for mobile testing -->
    <div id="debug" style="display: none; position: fixed; bottom: 0; left: 0; background: rgba(0,0,0,0.7); color: white; padding: 10px; font-family: monospace; width: 100%; height: 100px; overflow: auto; z-index: 1000;"></div>
    
    <!-- Custom scripts -->
    <script src="scripts/main.js"></script>
</body>
</html>